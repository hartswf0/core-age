<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genome | CORE-AGE</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600&family=JetBrains+Mono:wght@400;600&family=Inter:wght@300;400;600&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg: #030304;
            --surface: #0a0a0f;
            --surface-2: #14141a;
            --ink: #e8e8e8;
            --ink-dim: #888;
            --ink-muted: #555;
            --accent: #d97706;
            /* Amber for Core */
            --lego: #ef4444;
            /* Red for Lego */
            --tetrad: #8b5cf6;
            /* Purple for Tetrad */
            --wag: #ec4899;
            /* Pink for WAG */
            --trail: #06b6d4;
            /* Cyan for Trail */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg);
            color: var(--ink);
            font-family: 'Inter', sans-serif;
            line-height: 1.7;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        /* Header */
        header {
            text-align: center;
            padding: 60px 0 40px;
            border-bottom: 1px solid var(--surface-2);
            margin-bottom: 50px;
        }

        h1 {
            font-family: 'Crimson Pro', serif;
            font-size: 3.5rem;
            font-weight: 600;
            color: var(--ink);
            margin-bottom: 12px;
            letter-spacing: -0.02em;
        }

        h1 span {
            color: var(--accent);
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--ink-dim);
            max-width: 700px;
            margin: 0 auto;
        }

        .meta-info {
            margin-top: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--ink-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        /* Arc Diagram */
        .arc-section {
            background: var(--surface);
            border-radius: 12px;
            padding: 40px;
            margin-bottom: 60px;
            border: 1px solid var(--surface-2);
            position: relative;
            overflow: hidden;
        }

        .arc-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            opacity: 0.5;
        }

        .arc-title {
            font-family: 'Crimson Pro', serif;
            font-size: 1.8rem;
            color: var(--ink);
            margin-bottom: 30px;
            text-align: center;
        }

        .arc-flow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px 0;
            position: relative;
        }

        .arc-node {
            text-align: center;
            flex: 1;
            min-width: 140px;
            padding: 20px;
            background: var(--surface-2);
            border-radius: 8px;
            border: 1px solid transparent;
            transition: all 0.3s ease;
        }

        .arc-node:hover {
            transform: translateY(-5px);
            border-color: var(--ink-muted);
        }

        .arc-node.lego {
            border-top: 3px solid var(--lego);
        }

        .arc-node.tetrad {
            border-top: 3px solid var(--tetrad);
        }

        .arc-node.wag {
            border-top: 3px solid var(--wag);
        }

        .arc-node.trail {
            border-top: 3px solid var(--trail);
        }

        .arc-node .name {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--ink);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 8px;
        }

        .arc-node .phase {
            font-size: 0.75rem;
            color: var(--ink-dim);
        }

        .arc-arrow {
            color: var(--ink-muted);
            font-size: 1.5rem;
            opacity: 0.5;
        }

        /* Global Genome */
        .global-genome {
            margin-bottom: 80px;
        }

        .genome {
            background: var(--surface);
            border-radius: 10px;
            padding: 30px;
            border: 1px solid var(--surface-2);
        }

        .genome-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: var(--accent);
            margin-bottom: 20px;
            border-bottom: 1px dashed var(--surface-2);
            padding-bottom: 10px;
        }

        .genome-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
        }

        .genome-row {
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }

        .genome-key {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--accent);
            min-width: 24px;
            margin-top: 2px;
        }

        .genome-value {
            font-size: 0.9rem;
            color: var(--ink-dim);
            line-height: 1.6;
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 40px;
            max-width: 900px;
            margin: 0 auto;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 12px;
            top: 20px;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, var(--lego), var(--tetrad), var(--wag), var(--trail));
            opacity: 0.3;
        }

        /* Era Cards */
        .era {
            margin-bottom: 80px;
            position: relative;
            background: var(--surface);
            border: 1px solid var(--surface-2);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }

        .era:hover {
            transform: translateX(5px);
            border-color: var(--ink-muted);
        }

        .era::before {
            content: '';
            position: absolute;
            left: -44px;
            top: 30px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 4px solid var(--bg);
            z-index: 10;
        }

        .era.lego::before {
            background: var(--lego);
        }

        .era.tetrad::before {
            background: var(--tetrad);
        }

        .era.wag::before {
            background: var(--wag);
        }

        .era.trail::before {
            background: var(--trail);
        }

        .era-header {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 16px;
            border-bottom: 1px solid var(--surface-2);
            padding-bottom: 16px;
        }

        .era-name {
            font-family: 'Crimson Pro', serif;
            font-size: 2rem;
            font-weight: 600;
            color: var(--ink);
        }

        .era-meta {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            padding: 4px 12px;
            border-radius: 20px;
            background: var(--surface-2);
            color: var(--ink-dim);
        }

        .era.lego .era-name {
            color: var(--lego);
        }

        .era.tetrad .era-name {
            color: var(--tetrad);
        }

        .era.wag .era-name {
            color: var(--wag);
        }

        .era.trail .era-name {
            color: var(--trail);
        }

        .era-tagline {
            font-size: 1.1rem;
            color: var(--ink);
            margin-bottom: 24px;
            font-style: italic;
            border-left: 3px solid var(--surface-2);
            padding-left: 16px;
        }

        .artifacts-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 24px;
        }

        .artifact-card {
            background: var(--bg);
            padding: 12px;
            border-radius: 6px;
            border: 1px solid var(--surface-2);
            font-size: 0.8rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .artifact-card a {
            color: var(--ink);
            text-decoration: none;
            display: block;
            margin-bottom: 4px;
            font-weight: 600;
        }

        .artifact-card span {
            color: var(--ink-muted);
            font-size: 0.7rem;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 60px 0;
            border-top: 1px solid var(--surface-2);
            margin-top: 100px;
            color: var(--ink-muted);
            font-size: 0.8rem;
        }

        @media (max-width: 700px) {
            h1 {
                font-size: 2.5rem;
            }

            .arc-flow {
                flex-direction: column;
            }

            .arc-arrow {
                transform: rotate(90deg);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header id="header-section">
            <!-- Dynamic Header -->
            <h1>Project <span>Genome</span></h1>
            <p class="subtitle">Loading DNA Sequence...</p>
        </header>

        <!-- Global Genome -->
        <section class="global-genome" id="global-genome-section">
            <div class="genome">
                <div class="genome-title">MASTER SEQUENCE</div>
                <div class="genome-grid" id="master-genome-grid">
                    <!-- Dynamic Genome Keys -->
                </div>
            </div>
        </section>

        <!-- Arc Section -->
        <section class="arc-section">
            <h2 class="arc-title">The Evolutionary Arc</h2>
            <div class="arc-flow" id="arc-flow-container">
                <!-- Dynamic Arc Nodes -->
            </div>
        </section>

        <!-- Timeline / Eras -->
        <div class="timeline" id="timeline-container">
            <!-- Dynamic Era Cards -->
        </div>

        <footer>
            <p id="footer-text">Generated by Trail Olog Sequencer 2.0</p>
        </footer>
    </div>

    <!-- Embedded Data Fallback -->
    <script>
        const FALLBACK_GENOME_DATA = {
            "generated_at": "2025-12-11T16:55:00Z",
            "thesis": "Operative Ekphrasis: Text commands generate 3D geometry instantly.",
            "repository": "CORE-AGE",
            "genome_version": "2.0 (Deep Time)",
            "dna_base_pairs": {
                "L": "LEGO (Material Input)",
                "T": "TETRAD (Logic Process)",
                "W": "WAG (Language Synthesis)",
                "M": "MAP (Trail Awareness)"
            },
            "total_families": 4,
            "trail_levels": {
                "0": "FOSSIL - Historical artifacts",
                "1": "INPUT - Raw materials and parsing",
                "2": "PROCESS - Logic and sorting engines",
                "3": "SYNTHESIS - Narrative worldbuilding",
                "4": "OBSERVATORY - Meta-visualization"
            },
            "zones": [
                {
                    "id": "lego-inputs",
                    "label": "LEGO INPUTS",
                    "type": "valley",
                    "color": "#ef4444",
                    "position": { "x": 0.15, "y": 0.5 },
                    "trailLevel": 1,
                    "intent": "Parse raw LDraw geometry into 3D meshes.",
                    "pattern": "Mesh-Per-Line Architecture",
                    "decision": "Sacrificed performance for 100% data provenance.",
                    "artifacts": [
                        { "text": "lego-3d-architect.html", "type": "artifact", "path": "lego-3d-architect.html" },
                        { "text": "timber-master.html", "type": "artifact", "path": "timber-master.html" },
                        { "text": "line-22-autopsy.html", "type": "fossil", "path": "line-22-autopsy.html" }
                    ]
                },
                {
                    "id": "tetrad-engine",
                    "label": "TETRAD ENGINE",
                    "type": "plateau",
                    "color": "#8b5cf6",
                    "position": { "x": 0.4, "y": 0.3 },
                    "trailLevel": 2,
                    "intent": "Sort complexity using McLuhan's four laws.",
                    "pattern": "9x9 Invariant Grid",
                    "decision": "The Grid is the physics engine for all knowledge.",
                    "artifacts": [
                        { "text": "thousand-tetrad.html", "type": "artifact", "path": "thousand-tetrad.html" },
                        { "text": "gar-tao.html", "type": "artifact", "path": "gar-tao.html" },
                        { "text": "disentangling-strategy.html", "type": "artifact", "path": "disentangling-strategy.html" }
                    ]
                },
                {
                    "id": "wag-peaks",
                    "label": "WAG PEAKS",
                    "type": "mountain",
                    "color": "#ec4899",
                    "position": { "x": 0.65, "y": 0.2 },
                    "trailLevel": 3,
                    "intent": "Translate natural language into spatial worlds.",
                    "pattern": "Operative Ekphrasis",
                    "decision": "Text IS the World (No database required).",
                    "artifacts": [
                        { "text": "wag-workshop.html", "type": "artifact", "path": "wag-workshop.html" },
                        { "text": "gar-onyx-studio.html", "type": "artifact", "path": "gar-onyx-studio.html" },
                        { "text": "wag-brave.html", "type": "artifact", "path": "wag-brave.html" }
                    ]
                },
                {
                    "id": "trail-observatory",
                    "label": "TRAIL OBSERVATORY",
                    "type": "satellite",
                    "color": "#06b6d4",
                    "position": { "x": 0.85, "y": 0.1 },
                    "trailLevel": 4,
                    "intent": "Visualize the creator's journey as a map.",
                    "pattern": "Genome Sequencing",
                    "decision": "Visualize metadata as a playable territory.",
                    "artifacts": [
                        { "text": "courage-trail-olog.html", "type": "artifact", "path": "courage-trail-olog.html" },
                        { "text": "courage-genome.html", "type": "artifact", "path": "courage-genome.html" },
                        { "text": "GENOME_REPORT.md", "type": "artifact", "path": "GENOME_REPORT.md" }
                    ]
                }
            ],
            "connections": [
                { "from": "lego-inputs", "to": "tetrad-engine", "label": "Raw Materials" },
                { "from": "tetrad-engine", "to": "wag-peaks", "label": "Sorted Logic" },
                { "from": "wag-peaks", "to": "trail-observatory", "label": "Synthesized World" },
                { "from": "trail-observatory", "to": "lego-inputs", "label": "Recursive Observation" }
            ],
            "timeline": [
                {
                    "date": "2025-11-12",
                    "label": "Line 22 Collapse",
                    "desc": "Monolithic loading failure destroys provenance.",
                    "active": ["lego-inputs"]
                },
                {
                    "date": "2025-11-15",
                    "label": "Architecture B Fix",
                    "desc": "Shift to Mesh-Per-Line architecture.",
                    "active": ["lego-inputs"]
                },
                {
                    "date": "2025-11-20",
                    "label": "Tetrad Discovery",
                    "desc": "McLuhan's laws applied to grid logic.",
                    "active": ["tetrad-engine"]
                },
                {
                    "date": "2025-12-02",
                    "label": "WAG Workshop",
                    "desc": "First public demo of Words Assemble Geometry.",
                    "active": ["wag-peaks"]
                },
                {
                    "date": "2025-12-11",
                    "label": "Genome Sequencing",
                    "desc": "Deep sequence of repository DNA.",
                    "active": ["trail-observatory"]
                }
            ]
        };
    </script>

    <script>
        async function loadGenome() {
            try {
                const response = await fetch('courage-trail-data.json');
                if (!response.ok) throw new Error('Failed to load genome data');
                const data = await response.json();
                renderGenome(data);
            } catch (err) {
                console.warn("Fetch failed, using embedded fallback data:", err);
                if (typeof FALLBACK_GENOME_DATA !== 'undefined') {
                    renderGenome(FALLBACK_GENOME_DATA);
                    // Add a small note about fallback mode
                    const footer = document.getElementById('footer-text');
                    footer.innerHTML += ' <span style="color:var(--ink-muted)">(Offline Mode)</span>';
                } else {
                    document.querySelector('.subtitle').innerHTML = `<span style="color:var(--lego)">Error loading genome data: ${err.message}.<br>This viewer requires a local server (python3 -m http.server) or correct file path.</span>`;
                }
            }
        }

        function renderGenome(data) {
            // 1. Render Header
            const header = document.getElementById('header-section');
            header.querySelector('.subtitle').innerHTML = `Deep Sequence of the <strong>${data.repository}</strong> Repository`;
            const metaInfo = document.createElement('p');
            metaInfo.className = 'meta-info';
            metaInfo.innerHTML = `Sequenced: ${new Date(data.generated_at).toLocaleDateString()} · Version: ${data.genome_version || 'Unknown'}`;
            header.appendChild(metaInfo);

            // 2. Render Master Genome (Base Pairs)
            const grid = document.getElementById('master-genome-grid');
            grid.innerHTML = '';

            // Render Base Pairs first
            if (data.dna_base_pairs) {
                Object.entries(data.dna_base_pairs).forEach(([key, value]) => {
                    grid.innerHTML += `
                        <div class="genome-row">
                            <span class="genome-key">${key}</span>
                            <span class="genome-value">${value}</span>
                        </div>`;
                });
            }

            // Render Core Thesis/Intent if available in root or mapped
            if (data.thesis) {
                grid.innerHTML += `
                        <div class="genome-row">
                            <span class="genome-key">THESIS</span>
                            <span class="genome-value">${data.thesis}</span>
                        </div>`;
            }


            // 3. Render Arc Diagram
            const arcContainer = document.getElementById('arc-flow-container');
            arcContainer.innerHTML = '';

            // Sort zones by trailLevel to ensure correct flow
            const sortedZones = data.zones.sort((a, b) => (a.trailLevel || 0) - (b.trailLevel || 0));

            sortedZones.forEach((zone, index) => {
                const node = document.createElement('div');
                node.className = `arc-node ${getZoneClass(zone.id)}`;
                node.innerHTML = `
                    <div class="name">${zone.label}</div>
                    <div class="phase">LEVEL ${zone.trailLevel}</div>
                `;
                arcContainer.appendChild(node);

                // Add arrow if not last
                if (index < sortedZones.length - 1) {
                    const arrow = document.createElement('div');
                    arrow.className = 'arc-arrow';
                    arrow.textContent = '→';
                    arcContainer.appendChild(arrow);
                }
            });

            // 4. Render Timeline / Eras (Zones as Eras)
            const timelineContainer = document.getElementById('timeline-container');
            timelineContainer.innerHTML = '';

            sortedZones.forEach(zone => {
                const article = document.createElement('article');
                article.className = `era ${getZoneClass(zone.id)}`;

                // Construct Artifacts List
                const artifactsHtml = (zone.artifacts || []).map(art => `
                    <div class="artifact-card">
                        <a href="${art.path}" target="_blank">${art.text}</a>
                        <span>Type: ${art.type}</span>
                    </div>
                `).join('');

                // Find relevant timeline events for this zone
                const events = (data.timeline || []).filter(e => e.active && e.active.includes(zone.id));
                const eventHtml = events.length ? events.map(e => `<div style="margin-bottom:8px; font-size:0.8rem; color:var(--ink-dim)"><strong>${e.date}</strong>: ${e.label}</div>`).join('') : '';

                article.innerHTML = `
                    <div class="era-header">
                        <h2 class="era-name">${zone.label}</h2>
                        <span class="era-meta">Trails Level ${zone.trailLevel}</span>
                    </div>
                    <p class="era-tagline">${zone.intent || zone.desc || 'No intent defined.'}</p>
                    
                    <div class="genome">
                        <div class="genome-title">Zone Genome</div>
                        <div class="genome-grid">
                            ${zone.decision ? `<div class="genome-row"><span class="genome-key">Decision</span><span class="genome-value">${zone.decision}</span></div>` : ''}
                            ${zone.pattern ? `<div class="genome-row"><span class="genome-key">Pattern</span><span class="genome-value">${zone.pattern}</span></div>` : ''}
                            <div class="genome-row" style="margin-top:10px; display:block;">
                                ${eventHtml}
                            </div>
                        </div>
                    </div>

                    ${artifactsHtml ? `<div class="artifacts-list">${artifactsHtml}</div>` : ''}
                `;
                timelineContainer.appendChild(article);
            });

            document.getElementById('footer-text').textContent = `Generated by Trail Olog Sequencer 2.0 · ${data.repository} Repository Genome`;
        }

        function getZoneClass(id) {
            if (id.includes('lego')) return 'lego';
            if (id.includes('tetrad')) return 'tetrad';
            if (id.includes('wag')) return 'wag';
            if (id.includes('trail')) return 'trail';
            return ''; // default
        }

        // Initialize
        loadGenome();
    </script>
</body>

</html>